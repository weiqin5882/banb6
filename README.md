# 快手小店订单比对与利润统计系统（Web版）

面向财务对账场景的网页版系统：上传官方订单与客服统计表，一键完成清洗、比对、查漏、利润计算并导出标准Excel报表。

## 功能覆盖

- 支持浏览器访问（Flask Web应用）
- 支持上传官方订单表、客服订单表
- 支持列名不一致时手动映射字段
- 自动清洗订单号（去空格、去特殊符号、仅保留数字）
- 自动去重（按订单号保留首条）
- 官方表仅保留 `交易成功`、`已发货`、`已收货` 参与统计
- 自动识别：
  - 官方有/客服无 -> `客服漏记`
  - 客服有/官方无 -> `异常订单`
- 自动计算：销售额、成本、利润（利润=销售额-成本）
- 汇总中的销售额/成本/利润仅统计官方表中状态为 `交易成功` / `已收货` 的数据（其他状态及异常行均不计入汇总金额）
- 亏损订单高亮红色，异常订单高亮
- 结果分页预览（默认50条/页）
- 导出Excel：自动列宽、亏损标红、异常高亮、底部汇总统计
- `.et` 文件给出友好提示，要求另存为 `.xlsx`

## 启动方式

```bash
pip install -r requirements.txt
python app.py
```

访问：`http://127.0.0.1:8000`

## 使用步骤

1. 上传官方订单和客服订单文件
2. 点击“读取文件并加载映射”
3. 配置映射字段（订单号、商品名称、销售额必填；官方状态（交易状态）必填；成本可选，缺失时用默认成本）
4. 点击“开始对比”
5. 分页查看结果并导出 Excel


## 常见问题

- 页面提示 `Failed to fetch`：说明前端没连上后端接口。请先运行 `python app.py`，并用浏览器访问 `http://127.0.0.1:8000`（不要只打开本地 html 文件）。
